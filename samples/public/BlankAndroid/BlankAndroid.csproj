<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net10.0-android</TargetFramework>
    <SupportedOSPlatformVersion>24</SupportedOSPlatformVersion>
    <OutputType>Exe</OutputType>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <ApplicationId>com.companyname.BlankAndroid</ApplicationId>
    <ApplicationVersion>1</ApplicationVersion>
    <ApplicationDisplayVersion>1.0</ApplicationDisplayVersion>
    <TrimMode>partial</TrimMode>
    
    <!-- Mark as a test project - this enables all testing infrastructure -->
    <IsTestProject>true</IsTestProject>
    
    <!-- Enable Microsoft Testing Platform -->
    <IsTestingPlatformApplication>true</IsTestingPlatformApplication>
    <EnableMSTestRunner>true</EnableMSTestRunner>
    <GenerateTestingPlatformEntryPoint>true</GenerateTestingPlatformEntryPoint>
    
    <!-- Use MSTest Engine (source generation based) for device testing -->
    <UseMSTestEngine>true</UseMSTestEngine>
    <UseMSTestAdapter>false</UseMSTestAdapter>
    
    <!-- Device test project - uses MSBuild infrastructure instead of VSTest -->
    <!-- This is set automatically by Microsoft.Testing.Platform.MSBuild.DeviceTesting.targets -->
    <!-- but we set it here for compatibility with older package versions -->
    <_IsDeviceTestProject>true</_IsDeviceTestProject>
    <UseMSBuildTestInfrastructure>true</UseMSBuildTestInfrastructure>
  </PropertyGroup>

  <ItemGroup>
    <!-- Use source-generated MSTest for device testing (no PlatformServices dependency) -->
    <PackageReference Include="MSTest.TestFramework" Version="$(MSTestVersion)" />
    <PackageReference Include="MSTest.Analyzers" Version="$(MSTestVersion)" />
    <PackageReference Include="Microsoft.Testing.Platform" Version="$(TestingPlatformVersion)" />
    <PackageReference Include="Microsoft.Testing.Platform.MSBuild" Version="$(TestingPlatformVersion)" />
    <PackageReference Include="Microsoft.Testing.Extensions.TrxReport" Version="$(TestingPlatformVersion)" />
    <PackageReference Include="MSTest.Engine" Version="$(MSTestAOTVersion)" />
    <PackageReference Include="MSTest.SourceGeneration" Version="$(MSTestAOTVersion)" />
  </ItemGroup>

  <!-- Register custom device testing extensions -->
  <ItemGroup>
    <TestingPlatformBuilderHook Include="DeviceTestingExtensions">
      <DisplayName>Device Testing Extensions</DisplayName>
      <TypeFullName>BlankAndroid.DeviceTestingPlatformBuilderHook</TypeFullName>
    </TestingPlatformBuilderHook>
  </ItemGroup>
</Project>