<Project>
  <!--
    Device Testing Targets
    ======================
    This file configures the build targets for device testing (Android/iOS).
    
    In production, these targets would be imported automatically from the platform SDKs
    (dotnet/android, dotnet/ios) when a project targets a device TFM and has IsTestProject=true.
    
    For local development, we import them from the source projects.
  -->
  
  <!-- 
    Import Microsoft.Testing.Platform.MSBuild targets for entry point generation.
    When using project references instead of package references, we need to manually import these.
  -->
  <PropertyGroup>
    <MicrosoftTestingPlatformMSBuildTaskFolder>$(MSBuildThisFileDirectory)../../../artifacts/bin/Microsoft.Testing.Platform.MSBuild/$(Configuration)/net9.0/</MicrosoftTestingPlatformMSBuildTaskFolder>
  </PropertyGroup>
  
  <Import Project="$(MSBuildThisFileDirectory)../../../src/Platform/Microsoft.Testing.Platform.MSBuild/buildMultiTargeting/Microsoft.Testing.Platform.MSBuild.targets" />
  
  <!-- 
    Override _MTPBeforeVSTest to prevent error for device projects.
    Device projects use MSBuild test infrastructure instead of VSTest.
  -->
  <Target Name="_MTPBeforeVSTest" BeforeTargets="VSTest" Condition="'$(_IsDeviceTestProject)' == 'true'">
    <Message Text="Device test project detected - using MSBuild test infrastructure" Importance="high" />
  </Target>
  
  <!-- Import platform-specific device testing targets -->
  <Import Project="$(MSBuildThisFileDirectory)Sdk.DeviceTesting.Android.targets"
          Condition="$(TargetFramework.Contains('android'))" />
</Project>
